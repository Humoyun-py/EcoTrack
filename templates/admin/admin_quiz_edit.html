{% extends "admin/admin_base.html" %}

{% block title %}Quizni Tahrirlash - EcoTrack{% endblock %}

{% block admin_content %}
<div class="admin-header">
    <h1>Quizni Tahrirlash: {{ quiz.title }}</h1>
    <a href="{{ url_for('admin.admin_quizzes') }}" class="btn btn-secondary">
        ‚Üê Quizlar Ro'yxati
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h3>üìù Quiz Ma'lumotlari</h3>
    </div>
    <div class="card-content" style="padding: var(--space-xl);">
        <div class="quiz-info">
            <p><strong>Nomi:</strong> {{ quiz.title }}</p>
            <p><strong>Tavsif:</strong> {{ quiz.description or "Tavsif mavjud emas" }}</p>
            <p><strong>Savollar soni:</strong> {{ quiz.questions|length }}</p>
            <p><strong>Holati:</strong> 
                <span class="badge {% if quiz.is_active %}badge-success{% else %}badge-error{% endif %}">
                    {{ 'Aktiv' if quiz.is_active else 'Nofaol' }}
                </span>
            </p>
        </div>
    </div>
</div>

<!-- Add Question Form -->
<div class="card" style="margin-top: var(--space-lg);">
    <div class="card-header">
        <h3>‚ûï Yangi Savol Qo'shish</h3>
    </div>
    <div class="card-content" style="padding: var(--space-xl);">
        <form method="POST" action="{{ url_for('admin.admin_question_add', quiz_id=quiz.id) }}" class="question-form">
            <div class="form-group">
                <label for="question_text" class="form-label">Savol Matni</label>
                <textarea id="question_text" name="question_text" class="form-input" 
                          rows="3" placeholder="Savol matnini kiriting..." required></textarea>
            </div>
            
            <div class="options-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md); margin: var(--space-lg) 0;">
                <div class="form-group">
                    <label for="option_a" class="form-label">A Varianti</label>
                    <input type="text" id="option_a" name="option_a" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="option_b" class="form-label">B Varianti</label>
                    <input type="text" id="option_b" name="option_b" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="option_c" class="form-label">C Varianti</label>
                    <input type="text" id="option_c" name="option_c" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="option_d" class="form-label">D Varianti</label>
                    <input type="text" id="option_d" name="option_d" class="form-input" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="correct_answer" class="form-label">To'g'ri Javob</label>
                <select id="correct_answer" name="correct_answer" class="form-input" required>
                    <option value="">Tanlang...</option>
                    <option value="A">A Varianti</option>
                    <option value="B">B Varianti</option>
                    <option value="C">C Varianti</option>
                    <option value="D">D Varianti</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="points" class="form-label">Ball</label>
                <input type="number" id="points" name="points" class="form-input" value="1" min="1">
            </div>
            
            <button type="submit" class="btn btn-primary">
                ‚úÖ Savol Qo'shish
            </button>
        </form>
    </div>
</div>

<!-- Existing Questions -->
<div class="card" style="margin-top: var(--space-lg);">
    <div class="card-header">
        <h3>üìã Mavjud Savollar ({{ quiz.questions|length }})</h3>
    </div>
    <div class="card-content">
        {% if quiz.questions %}
        <div class="questions-list">
            {% for question in quiz.questions %}
            <div class="question-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--space-lg); margin-bottom: var(--space-md);">
                <div style="display: flex; justify-content: between; align-items: start; margin-bottom: var(--space-md);">
                    <h4 style="flex: 1; margin: 0;">{{ question.question_text }}</h4>
                    <span class="badge" style="background: var(--primary); color: white; padding: 4px 8px; border-radius: 6px;">
                        {{ question.points }} ball
                    </span>
                </div>
                
                <div class="options-list" style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-sm);">
                    <div class="option {% if question.correct_answer == 'A' %}correct-option{% endif %}">
                        <strong>A:</strong> {{ question.option_a }}
                    </div>
                    <div class="option {% if question.correct_answer == 'B' %}correct-option{% endif %}">
                        <strong>B:</strong> {{ question.option_b }}
                    </div>
                    <div class="option {% if question.correct_answer == 'C' %}correct-option{% endif %}">
                        <strong>C:</strong> {{ question.option_c }}
                    </div>
                    <div class="option {% if question.correct_answer == 'D' %}correct-option{% endif %}">
                        <strong>D:</strong> {{ question.option_d }}
                    </div>
                </div>
                
                <div style="margin-top: var(--space-md); display: flex; gap: var(--space-xs);">
                    <button class="btn btn-sm btn-secondary">‚úèÔ∏è Tahrirlash</button>
                    <button class="btn btn-sm btn-error">üóëÔ∏è O'chirish</button>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state" style="text-align: center; padding: var(--space-2xl);">
            <div style="font-size: 4rem; margin-bottom: var(--space-md);">‚ùì</div>
            <h3>Hali savollar mavjud emas</h3>
            <p>Yuqoridagi forma orqali birinchi savolingizni qo'shing</p>
        </div>
        {% endif %}
    </div>
</div>

<style>
.correct-option {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid var(--success);
    border-radius: var(--radius-sm);
    padding: var(--space-xs);
}
</style>
{% endblock %}